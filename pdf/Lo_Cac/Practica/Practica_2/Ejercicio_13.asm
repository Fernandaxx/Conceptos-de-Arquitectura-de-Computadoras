TIMER EQU 10H 
PIC EQU 20H 
EOI EQU 20H 
N_CLK EQU 10 
  
 ORG 40 
IP_CLK DW RUT_CLK 
  
 ORG 1000H 
MIN DB 30H
MIN2 DB 30H
SEP DB ":"
SEG DB 30H 
SEG2 DB 30H 
FIN DB ? 
  
 ORG 3000H 
    CLEAN DB 12
LIMPIAR_CONSOLA: 
    PUSH BX
    PUSH AX
    MOV BX, OFFSET CLEAN
    MOV AL, 1
    INT 7
    POP AX
    POP BX
    RET

RUT_CLK:  PUSH AX 
 ADD SEG2, 10
 CMP SEG2, 3AH 
 JNZ RESET 
 MOV SEG2, 30H 
 INC SEG 
 CMP SEG, 36H 
 JNZ RESET 
 MOV SEG, 30H 
 
 INC MIN2
 CMP MIN2, 3AH 
 JNZ RESET 
 MOV MIN2, 30H 
 INC MIN 
 CMP MIN, 36H 
 JNZ RESET 
 MOV MIN, 30H 
 
RESET: 
  CALL LIMPIAR_CONSOLA
  INT 7 
 MOV AL, 0 
 OUT TIMER, AL 
 MOV AL, EOI 
 OUT PIC, AL 
 POP AX 
 IRET 
  
 ORG 2000H 
 CLI 
 MOV AL, 0FDH 
 OUT PIC+1, AL       ; PIC: registro IMR 
 MOV AL, N_CLK  
 OUT PIC+5, AL       ; PIC: registro INT1 
 MOV AL, 10 
 OUT TIMER+1, AL     ; TIMER: registro COMP 
 MOV AL, 0 
 OUT TIMER, AL       ; TIMER: registro CONT 
 MOV BX, OFFSET MIN 
 MOV AL, OFFSET FIN-OFFSET MIN 
 STI 
LAZO: JMP LAZO 
  
 END